//
// Created by HORIA on 29.12.2023.
//

#ifndef MALWARE_TYPES_OOP_MALWARE_H
#define MALWARE_TYPES_OOP_MALWARE_H

#include <list>
#include <string>
#include <vector>
#include <functional>

class Malware {
public:
    explicit Malware(double impactRating=0.0, int day=1, int month=1,int year=1970, std::string name="",
                     std::string infectionMethod="Unknown", std::list<std::string> modifiedRegisters={});
    virtual ~Malware()=default;
    //getters
    [[nodiscard]] double get_impact_rating();
    int* get_date();
    [[nodiscard]] std::string get_name() const;
    [[nodiscard]] std::string get_infection_method() const;
    [[nodiscard]] std::list<std::string> get_modified_registers() const;
    //setters
    void set_impact_rating(double impactRating);
    void set_date(const int date[]);
    void set_name(const std::string& name);
    void set_infection_method(const std::string& infectionMethod);
    void set_modifiedRegisters(const std::list<std::string>& modifiedRegisters);
    virtual void update_impact_rating() = 0;
    virtual void afisare();
    void read();
    static void tokenize(std::string_view s, std::list<std::string>& l, std::string_view delim);
protected:
    static bool is_in(std::string_view s, const std::vector<std::string>& v);
    static double calculateRating(double val, const std::list<std::string>& l,const std::vector<std::string>& v, const std::function<double (double val)>& calc);
    double check_for_vulnerable_registers();
private:
    double m_impactRating {};
    int m_date[3];
    std::string m_name {};
    std::string m_infectionMethod {};
    std::list<std::string> m_modifiedRegisters {};
};


#endif //MALWARE_TYPES_OOP_MALWARE_H
