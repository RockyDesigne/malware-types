//
// Created by HORIA on 29.12.2023.
//

#ifndef MALWARE_TYPES_OOP_KERNELKEYLOGGER_H
#define MALWARE_TYPES_OOP_KERNELKEYLOGGER_H

#include "RootKit.h"
#include "Keylogger.h"
#include <istream>
#include <list>
#include <string>
#include <vector>

class KernelKeylogger : public RootKit, public Keylogger {
public:
    explicit KernelKeylogger (double impactRating=0.0, int day=1, int month=1,int year=1970, std::string name="",
                              std::string infectionMethod="Unknown", std::list<std::string> modifiedRegisters={}, bool hidingFiles=false,
                              bool hidingRegisters=false);
    //getters
    [[nodiscard]] bool get_hiding_files() const;
    [[nodiscard]] bool get_hiding_registers() const;
    //setters
    void set_hiding_files(bool hidingFiles);
    void set_hiding_registers(bool hidingResgisters);
    void update_impact_rating() override;
    std::istream& read(std::istream& in) override;
    std::ostream& print(std::ostream& out) override;
private:
    bool m_hidingFiles {};
    bool m_hidingRegisters {};

};


#endif //MALWARE_TYPES_OOP_KERNELKEYLOGGER_H
