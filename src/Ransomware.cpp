//
// Created by HORIA on 29.12.2023.
//

#include "Ransomware.h"

#include <iostream>

Ransomware::Ransomware(double impactRating, int day, int month, int year, std::string name, std::string infectionMethod,
                       std::list<std::string> modifiedRegisters, int cryptoRating, double obfuscationRating) : Malware{impactRating,day,month,year,std::move(name),std::move(infectionMethod),std::move(modifiedRegisters)},
                                                                                                               m_cryptoRating{cryptoRating}, m_obfuscationRating{obfuscationRating} {}

int Ransomware::get_crypto_rating() const {return m_cryptoRating;}

double Ransomware::get_obfuscation_rating() const {return m_obfuscationRating;}

void Ransomware::set_crypto_rating(int cryptoRating) {m_cryptoRating=cryptoRating;}

void Ransomware::set_obfuscation_rating(double obfuscationRating) {m_obfuscationRating=obfuscationRating;}

void Ransomware::update_impact_rating() {
    set_impact_rating(Malware::check_for_vulnerable_registers() + m_cryptoRating + m_obfuscationRating);
}

void Ransomware::afisare() {
    Malware::afisare();
    std::cout << "Ratingul crypto este: "<< m_cryptoRating << " si raatingul de obfuscare este: " << m_obfuscationRating << '\n';
}
